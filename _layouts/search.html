---
layout: default
---

{% if page.header.overlay_color or page.header.overlay_image or page.header.image %}
{% include page__hero.html %}
{% endif %}

{% if page.url != "/" and site.breadcrumbs %}
{% unless paginator %}
{% include breadcrumbs.html %}
{% endunless %}
{% endif %}

<div id="main" role="main">
  {% include sidebar.html %}

  <div class="archive">
    {% unless page.header.overlay_color or page.header.overlay_image %}
    <h1 id="page-title" class="page__title">{{ page.title }}</h1>
    {% endunless %}

    {{ content }}

    {%- assign search_provider = site.search_provider | default: "lunr" -%}
    {%- case search_provider -%}
    {%- when "lunr" -%}
    <input type="text" id="search" class="search-input" placeholder="{{ site.data.ui-text[site.locale].search_placeholder_text | default: 'Enter your search term...' }}" />
    <div id="results" class="results"></div>

    <!-- Lunr.js 스크립트 추가 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        // JSON 파일 로드 및 검색 인덱스 구축
        fetch('/search.json')
          .then(response => response.json())
          .then(data => {
            // Lunr.js 인덱스 생성
            var idx = lunr(function () {
              this.ref('url'); // 문서의 URL을 참조로 설정
              this.field('title'); // 제목 필드
              this.field('content'); // 본문 내용 필드

              data.forEach(function (doc) {
                this.add(doc); // 각 문서를 인덱스에 추가
              }, this);
            });

            // 검색창에서 입력 시 검색 수행
            document.getElementById('search').addEventListener('input', function () {
              var query = this.value;
              var results = idx.search(query); // 검색어로 인덱스에서 검색

              // 검색 결과 표시
              var resultsList = document.getElementById('results');
              resultsList.innerHTML = ''; // 기존 검색 결과 비우기

              results.forEach(function (result) {
                var item = data.find(doc => doc.url === result.ref); // URL로 문서 찾기
                var li = document.createElement('li');
                var a = document.createElement('a');
                a.href = item.url;
                a.textContent = item.title; // 검색된 문서의 제목 표시
                li.appendChild(a);
                resultsList.appendChild(li); // 결과를 목록에 추가
              });
            });
          });
      });
    </script>

    {%- when "google" -%}
    <form onsubmit="return googleCustomSearchExecute();" id="cse-search-box-form-id">
      <input type="text" id="cse-search-input-box-id" class="search-input" placeholder="{{ site.data.ui-text[site.locale].search_placeholder_text | default: 'Enter your search term...' }}" />
    </form>
    <div id="results" class="results">
      <gcse:searchresults-only></gcse:searchresults-only>
    </div>
    {%- when "algolia" -%}
    <div class="search-searchbar"></div>
    <div class="search-hits"></div>
    {%- endcase -%}
  </div>
</div>
